{% extends "layout/basic.html" %}
{% load render_table from django_tables2 %}
{% load bootstrap4 %}
{% load crispy_forms_tags %}
{% load static %}
{% block title %}Статистика{% endblock %}
{% block nav5 %}active{% endblock %}
{% block content %}
<div class="content-header">
  <div class="container-fluid">
    <div class="row mb-2">
      <div class="col-sm-6">
        <h1>Статистика</h1>
      </div><!-- /.col -->
    </div><!-- /.row -->
  </div><!-- /.container-fluid -->
</div>
    <section class="content">
    <div class="container-fluid">
        <div class="row">
            <div class="col-md-6">
                <div class="card card-success">
                  <div class="card-header">
                    <h3 class="card-title">Назначения</h3>

                    <div class="card-tools">
                      <button type="button" class="btn btn-tool" data-card-widget="collapse"><i class="fas fa-minus"></i>
                      </button>
                      <button type="button" class="btn btn-tool" data-card-widget="remove"><i class="fas fa-times"></i></button>
                    </div>
                  </div>
                  <div class="card-body">
                    <div class="chart">
                        <div class="chartjs-size-monitor">
                            <div class="chartjs-size-monitor-expand">
                                <div class="">

                                </div>
                            </div>
                            <div class="chartjs-size-monitor-shrink">
                                <div class="">

                                </div>
                            </div>
                        </div>
                      <canvas id="barChart" ></canvas>
                    </div>
                  </div>
                  <!-- /.card-body -->
                </div>
                <div class="card card-success">
                  <div class="card-header">

                    <div class="card-tools">
                      <button type="button" class="btn btn-tool" data-card-widget="collapse"><i class="fas fa-minus"></i>
                      </button>
                      <button type="button" class="btn btn-tool" data-card-widget="remove"><i class="fas fa-times"></i></button>
                    </div>
                  </div>
                  <div class="card-body">
                    <div class="chart">
                    </div>
                  </div>
                  <!-- /.card-body -->
                </div>
            </div>
            <div class="col-md-6">
                <div class="card card-warning">
                  <div class="card-header">
                    <h3 class="card-title">Жалобы</h3>
                    <div class="card-tools">
                      <button type="button" class="btn btn-tool" data-card-widget="collapse"><i class="fas fa-minus"></i>
                      </button>
                      <button type="button" class="btn btn-tool" data-card-widget="remove"><i class="fas fa-times"></i></button>
                    </div>
                  </div>
                  <div class="card-body">
                    <div class="chart">
                        <div class="chartjs-size-monitor">
                            <div class="chartjs-size-monitor-expand">
                                <div class="">

                                </div>
                            </div>
                            <div class="chartjs-size-monitor-shrink">
                                <div class="">

                                </div>
                            </div>
                        </div>
                      <canvas id="barChart1" ></canvas>
                    </div>
                  </div>
                  <!-- /.card-body -->
                </div>
            </div>
        </div>
    </div>
    </section>
{% endblock %}
{% block ends %}
    <script>
$(function () {
    var areaChartData = {
      labels  : ['{{ dates.min.0 }}', '{{ dates.min.1 }}', '{{ dates.min.2 }}', '{{ dates.min.3 }}',
                '{{ dates.min.4 }}', '{{ dates.min.5 }}', '{{ dates.min.6 }}'],
      datasets: [
        {
          label               : 'Количетсво созданных назначений',
          backgroundColor     : 'rgba(60,141,188,0.9)',
          borderColor         : 'rgba(60,141,188,0.8)',
          pointRadius          : false,
          pointColor          : '#3b8bba',
          pointStrokeColor    : 'rgba(60,141,188,1)',
          pointHighlightFill  : '#fff',
          pointHighlightStroke: 'rgba(60,141,188,1)',
          data                : [{{ kolvo.terms.0 }}, {{ kolvo.terms.1 }}, {{ kolvo.terms.2 }}, {{ kolvo.terms.3 }},
                                {{ kolvo.terms.4 }}, {{ kolvo.terms.5 }}, {{ kolvo.terms.6 }}]
        }
      ]
    }

    var areaChartData2 = {
      labels  : ['{{ dates.plus.0 }}', '{{ dates.plus.1 }}', '{{ dates.plus.2 }}', '{{ dates.plus.3 }}',
                '{{ dates.plus.4 }}', '{{ dates.plus.5 }}', '{{ dates.plus.6 }}'],
      datasets: [
        {
          label               : 'Количество жалоб подходящий срок ответа',
          backgroundColor     : 'rgba(60,141,188,0.9)',
          borderColor         : 'rgba(60,141,188,0.8)',
          pointRadius          : false,
          pointColor          : '#3b8bba',
          pointStrokeColor    : 'rgba(60,141,188,1)',
          pointHighlightFill  : '#fff',
          pointHighlightStroke: 'rgba(60,141,188,1)',
          data                : [{{ kolvo.problems.0 }}, {{ kolvo.problems.1 }}, {{ kolvo.problems.2 }}, {{ kolvo.problems.3 }},
                                {{ kolvo.problems.4 }}, {{ kolvo.problems.5 }}, {{ kolvo.problems.6 }}]
        }
      ]
    }

    var areaChartOptions = {
      maintainAspectRatio : false,
      responsive : true,
      legend: {
        display: false
      },
      scales: {
        xAxes: [{
          gridLines : {
            display : false,
          }
        }],
        yAxes: [{
          gridLines : {
            display : false,
          }
        }]
      }
    }

    //-------------
    //- BAR CHART -
    //-------------
    var barChartCanvas = $('#barChart').get(0).getContext('2d')
    var barChartData = jQuery.extend(true, {}, areaChartData)
    var temp0 = areaChartData.datasets[0]
    barChartData.datasets[0] = temp0

    var barChartOptions = {
      responsive              : true,
      maintainAspectRatio     : false,
      datasetFill             : false
    }

    var barChart = new Chart(barChartCanvas, {
      type: 'bar',
      data: barChartData,
      options: barChartOptions
    })

    var barChartCanvas2 = $('#barChart1').get(0).getContext('2d')
    var barChartData2 = jQuery.extend(true, {}, areaChartData2)
    var temp1 = areaChartData2.datasets[0]
    barChartData2.datasets[0] = temp1

    var barChart = new Chart(barChartCanvas2, {
      type: 'bar',
      data: barChartData2,
      options: barChartOptions
    })
  })
    </script>
{% endblock %}